<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Classes Dashboard</title>
    <link th:href="@{/webjars/bootstrap/5.3.0/css/bootstrap.min.css}" rel="stylesheet"/>
</head>

<body class="container mt-4">

<h2 class="text-success">Class Dashboard</h2>

<!-- =================== CLASS SELECTION =================== -->
<form method="get" th:action="@{/classes}">
    <div class="row mb-3">
        <div class="col-md-6">
            <select name="classId" class="form-select" required>
                <option value="">-- Choose Class --</option>
                <option th:each="c : ${classes}"
                        th:value="${c.id}"
                        th:text="${c.name}"
                        th:selected="${selectedClass != null and c.id == selectedClass.id}">
                </option>
            </select>
        </div>

        <div class="col-md-3">
            <button type="submit" class="btn btn-success w-100">
                View Dashboard
            </button>
        </div>
    </div>
</form>

<hr/>

<!-- =================== DASHBOARD SECTION =================== -->
<div th:if="${selectedClass != null}">

    <h3 class="text-primary mb-4"
        th:text="'Dashboard for ' + ${selectedClass.name}">
    </h3>

    <!-- ===== CLASS TEACHER ===== -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            Class Teacher
        </div>
        <div class="card-body">
            <div th:if="${selectedClass.classTeacher != null}">
                <strong>Name:</strong>
                <span th:text="${selectedClass.classTeacher.name}"></span>
            </div>

            <div th:if="${selectedClass.classTeacher == null}">
                <p class="text-danger">No class teacher assigned.</p>
            </div>
        </div>
    </div>

    <!-- ===== SUBJECT TEACHERS ===== -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            Subject Teachers
        </div>
        <div class="card-body">

            <table class="table table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Teacher</th>
                        <th>Subjects</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="teacher : ${selectedClass.teachers}">
                        <td th:text="${teacher.name}"></td>
                        <td>
                            <span th:each="subject : ${teacher.subjects}"
                                  th:text="${subject.name} + ' '"
                                  class="badge bg-success me-1">
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>

            <div th:if="${#lists.isEmpty(selectedClass.teachers)}">
                <p class="text-danger">No subject teachers assigned.</p>
            </div>

        </div>
    </div>

    <!-- ===== STUDENTS ===== -->
    <div class="card mb-4">
        <div class="card-header bg-secondary text-white">
            Students List
        </div>
        <div class="card-body">

            <table class="table table-bordered">
                <thead class="table-success">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="student : ${students}">
                        <td th:text="${student.id}"></td>
                        <td th:text="${student.name}"></td>
                    </tr>
                </tbody>
            </table>

            <div th:if="${#lists.isEmpty(students)}">
                <p class="text-danger">No students in this class yet.</p>
            </div>

        </div>
    </div>

</div>

</body>
</html>
